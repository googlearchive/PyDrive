

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>OAuth made easy &mdash; PyDrive2 1.7.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="File management made easy" href="filemanagement.html" />
    <link rel="prev" title="Quickstart" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> PyDrive2
          

          
          </a>

          
            
            
              <div class="version">
                1.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">OAuth made easy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#authentication-in-two-lines">Authentication in two lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="#automatic-and-custom-authentication-with-settings-yaml">Automatic and custom authentication with <em>settings.yaml</em></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sample-settings-yaml">Sample <em>settings.yaml</em></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#building-your-own-authentication-flow">Building your own authentication flow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="filemanagement.html">File management made easy</a></li>
<li class="toctree-l1"><a class="reference internal" href="filelist.html">File listing made easy</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydrive2.html">pydrive2 package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyDrive2</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>OAuth made easy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/oauth.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="oauth-made-easy">
<h1>OAuth made easy<a class="headerlink" href="#oauth-made-easy" title="Permalink to this headline">¶</a></h1>
<div class="section" id="authentication-in-two-lines">
<h2>Authentication in two lines<a class="headerlink" href="#authentication-in-two-lines" title="Permalink to this headline">¶</a></h2>
<p>OAuth2.0 is complex and difficult to start with. To make it more simple,
<em>PyDrive2</em> makes all authentication into just two lines.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pydrive2.auth</span> <span class="kn">import</span> <span class="n">GoogleAuth</span>

<span class="n">gauth</span> <span class="o">=</span> <span class="n">GoogleAuth</span><span class="p">()</span>
<span class="c1"># Create local webserver and auto handles authentication.</span>
<span class="n">gauth</span><span class="o">.</span><span class="n">LocalWebserverAuth</span><span class="p">()</span>

<span class="c1"># Or use the CommandLineAuth(), which provides you with a link to paste</span>
<span class="c1"># into your browser. The site it leads to then provides you with an</span>
<span class="c1"># authentication token which you paste into the command line.</span>
<span class="c1"># Commented out as it is an alternative to the LocalWebserverAuth() above,</span>
<span class="c1"># and someone will just copy-paste the entire thing into their editor.</span>

<span class="c1"># gauth.CommandLineAuth()</span>
</pre></div>
</div>
<p>To make this code work, you need to download the application configurations file
from APIs Console. Take a look at <a class="reference external" href="./quickstart.html#authentication">quickstart</a> for detailed instructions.</p>
<p><a class="reference external" href="./pydrive2.html#pydrive2.auth.GoogleAuth.LocalWebserverAuth">LocalWebserverAuth()</a> is a built-in method of <a class="reference external" href="./pydrive2.html#pydrive2.auth.GoogleAuth">GoogleAuth</a> which sets up
local webserver to automatically receive authentication code from user and
authorizes by itself. You can also use <a class="reference external" href="./pydrive2.html#pydrive.auth.GoogleAuth.CommandLineAuth">CommandLineAuth()</a> which manually
takes code from user at command line.</p>
</div>
<div class="section" id="automatic-and-custom-authentication-with-settings-yaml">
<h2>Automatic and custom authentication with <em>settings.yaml</em><a class="headerlink" href="#automatic-and-custom-authentication-with-settings-yaml" title="Permalink to this headline">¶</a></h2>
<p>Read this section if you need a custom authentication flow, <strong>such as silent
authentication on a remote machine</strong>. For an example of such a setup have a look
at <a class="reference internal" href="#sample-settings-yaml">Sample settings.yaml</a>.</p>
<p>OAuth is complicated and it requires a lot of settings. By default,
when you don’t provide any settings, <em>PyDrive</em> will automatically set default
values which works for most of the cases. Here are some default settings.</p>
<ul class="simple">
<li><p>Read client configuration from file <em>client_secrets.json</em></p></li>
<li><p>OAuth scope: <code class="code docutils literal notranslate"><span class="pre">https://www.googleapis.com/auth/drive</span></code></p></li>
<li><p>Don’t save credentials</p></li>
<li><p>Don’t retrieve refresh token</p></li>
</ul>
<p>However, you might want to customize these settings while maintaining two lines
of clean code. If that is the case, you can make <em>settings.yaml</em> file in your
working directory and <em>PyDrive</em> will read it to customize authentication
behavior.</p>
<p>These are all the possible fields of a <em>settings.yaml</em> file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">client_config_backend</span><span class="p">:</span> <span class="p">{{</span><span class="nb">str</span><span class="p">}}</span>
<span class="n">client_config_file</span><span class="p">:</span> <span class="p">{{</span><span class="nb">str</span><span class="p">}}</span>
<span class="n">client_config</span><span class="p">:</span>
  <span class="n">client_id</span><span class="p">:</span> <span class="p">{{</span><span class="nb">str</span><span class="p">}}</span>
  <span class="n">client_secret</span><span class="p">:</span> <span class="p">{{</span><span class="nb">str</span><span class="p">}}</span>
  <span class="n">auth_uri</span><span class="p">:</span> <span class="p">{{</span><span class="nb">str</span><span class="p">}}</span>
  <span class="n">token_uri</span><span class="p">:</span> <span class="p">{{</span><span class="nb">str</span><span class="p">}}</span>
  <span class="n">redirect_uri</span><span class="p">:</span> <span class="p">{{</span><span class="nb">str</span><span class="p">}}</span>
  <span class="n">revoke_uri</span><span class="p">:</span> <span class="p">{{</span><span class="nb">str</span><span class="p">}}</span>

<span class="n">save_credentials</span><span class="p">:</span> <span class="p">{{</span><span class="nb">bool</span><span class="p">}}</span>
<span class="n">save_credentials_backend</span><span class="p">:</span> <span class="p">{{</span><span class="nb">str</span><span class="p">}}</span>
<span class="n">save_credentials_file</span><span class="p">:</span> <span class="p">{{</span><span class="nb">str</span><span class="p">}}</span>

<span class="n">get_refresh_token</span><span class="p">:</span> <span class="p">{{</span><span class="nb">bool</span><span class="p">}}</span>

<span class="n">oauth_scope</span><span class="p">:</span> <span class="p">{{</span><span class="nb">list</span> <span class="n">of</span> <span class="nb">str</span><span class="p">}}</span>
</pre></div>
</div>
<p>Fields explained:</p>
<dl class="field-list simple">
<dt class="field-odd">client_config_backend (str)</dt>
<dd class="field-odd"><p>From where to read client configuration(API application settings such as client_id and client_secrets) from. Valid values are ‘file’ and ‘settings’. <strong>Default</strong>: ‘file’. <strong>Required</strong>: No.</p>
</dd>
<dt class="field-even">client_config_file (str)</dt>
<dd class="field-even"><p>When <em>client_config_backend</em> is ‘file’, path to the file containing client configuration. <strong>Default</strong>: ‘client_secrets.json’. <strong>Required</strong>: No.</p>
</dd>
<dt class="field-odd">client_config (dict)</dt>
<dd class="field-odd"><p>Place holding dictionary for client configuration when <em>client_config_backend</em> is ‘settings’. <strong>Required</strong>: Yes, only if <em>client_config_backend</em> is ‘settings’</p>
</dd>
<dt class="field-even">client_config[‘client_id’] (str)</dt>
<dd class="field-even"><p>Client ID of the application. <strong>Required</strong>: Yes, only if <em>client_config_backend</em> is ‘settings’</p>
</dd>
<dt class="field-odd">client_config[‘client_secret’] (str)</dt>
<dd class="field-odd"><p>Client secret of the application. <strong>Required</strong>: Yes, only if <em>client_config_backend</em> is ‘settings’</p>
</dd>
<dt class="field-even">client_config[‘auth_uri’] (str)</dt>
<dd class="field-even"><p>The authorization server endpoint URI. <strong>Default</strong>: ‘<a class="reference external" href="https://accounts.google.com/o/oauth2/auth">https://accounts.google.com/o/oauth2/auth</a>’. <strong>Required</strong>: No.</p>
</dd>
<dt class="field-odd">client_config[‘token_uri’] (str)</dt>
<dd class="field-odd"><p>The token server endpoint URI. <strong>Default</strong>: ‘<a class="reference external" href="https://accounts.google.com/o/oauth2/token">https://accounts.google.com/o/oauth2/token</a>’. <strong>Required</strong>: No.</p>
</dd>
<dt class="field-even">client_config[‘redirect_uri’] (str)</dt>
<dd class="field-even"><p>Redirection endpoint URI. <strong>Default</strong>: ‘<a class="reference external" href="urn:ietf:wg:oauth:2.0:oob">urn:ietf:wg:oauth:2.0:oob</a>’. <strong>Required</strong>: No.</p>
</dd>
<dt class="field-odd">client_config[‘revoke_uri’] (str)</dt>
<dd class="field-odd"><p>Revoke endpoint URI. <strong>Default</strong>: None. <strong>Required</strong>: No.</p>
</dd>
<dt class="field-even">save_credentials (bool)</dt>
<dd class="field-even"><p>True if you want to save credentials. <strong>Default</strong>: False. <strong>Required</strong>: No.</p>
</dd>
<dt class="field-odd">save_credentials_backend (str)</dt>
<dd class="field-odd"><p>Backend to save credentials to. ‘file’ is the only valid value for now. <strong>Default</strong>: ‘file’. <strong>Required</strong>: No.</p>
</dd>
<dt class="field-even">save_credentials_file (str)</dt>
<dd class="field-even"><p>Destination of credentials file. <strong>Required</strong>: Yes, only if <em>save_credentials_backend</em> is ‘file’.</p>
</dd>
<dt class="field-odd">get_refresh_token (bool)</dt>
<dd class="field-odd"><p>True if you want to retrieve refresh token along with access token. <strong>Default</strong>: False. <strong>Required</strong>: No.</p>
</dd>
<dt class="field-even">oauth_scope (list of str)</dt>
<dd class="field-even"><p>OAuth scope to authenticate. <strong>Default</strong>: [‘<a class="reference external" href="https://www.googleapis.com/auth/drive">https://www.googleapis.com/auth/drive</a>’]. <strong>Required</strong>: No.</p>
</dd>
</dl>
<div class="section" id="sample-settings-yaml">
<h3>Sample <em>settings.yaml</em><a class="headerlink" href="#sample-settings-yaml" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">client_config_backend</span><span class="p">:</span> <span class="n">settings</span>
<span class="n">client_config</span><span class="p">:</span>
  <span class="n">client_id</span><span class="p">:</span> <span class="mf">9637341109347.</span><span class="n">apps</span><span class="o">.</span><span class="n">googleusercontent</span><span class="o">.</span><span class="n">com</span>
  <span class="n">client_secret</span><span class="p">:</span> <span class="n">psDskOoWr1P602PXRTHi</span>

<span class="n">save_credentials</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">save_credentials_backend</span><span class="p">:</span> <span class="n">file</span>
<span class="n">save_credentials_file</span><span class="p">:</span> <span class="n">credentials</span><span class="o">.</span><span class="n">json</span>

<span class="n">get_refresh_token</span><span class="p">:</span> <span class="kc">True</span>

<span class="n">oauth_scope</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">googleapis</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">auth</span><span class="o">/</span><span class="n">drive</span><span class="o">.</span><span class="n">file</span>
  <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">googleapis</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">auth</span><span class="o">/</span><span class="n">drive</span><span class="o">.</span><span class="n">install</span>
  <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">googleapis</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">auth</span><span class="o">/</span><span class="n">drive</span><span class="o">.</span><span class="n">metadata</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="building-your-own-authentication-flow">
<h2>Building your own authentication flow<a class="headerlink" href="#building-your-own-authentication-flow" title="Permalink to this headline">¶</a></h2>
<p>You might want to build your own authentication flow. For example, you might
want to integrate your existing website with Drive API. In that case, you can
customize authentication flow as follwing:</p>
<ol class="arabic simple">
<li><p>Get authentication Url from <a class="reference external" href="./pydrive2.html#pydrive2.auth.GoogleAuth.GetAuthUrl">GetAuthUrl()</a>.</p></li>
<li><p>Ask users to visit the authentication Url and grant access to your application. Retrieve authentication code manually by user or automatically by building your own oauth2callback.</p></li>
<li><p>Call <a class="reference external" href="./pydrive2.html#pydrive2.auth.GoogleAuth.Auth">Auth(code)</a> with the authentication code you retrieved from step 2.</p></li>
</ol>
<p>Your <em>settings.yaml</em> will work for your customized authentication flow, too.</p>
<p>Here is a sample code for your customized authentication flow</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pydrive2.auth</span> <span class="kn">import</span> <span class="n">GoogleAuth</span>

<span class="n">gauth</span> <span class="o">=</span> <span class="n">GoogleAuth</span><span class="p">()</span>
<span class="n">auth_url</span> <span class="o">=</span> <span class="n">gauth</span><span class="o">.</span><span class="n">GetAuthUrl</span><span class="p">()</span> <span class="c1"># Create authentication url user needs to visit</span>
<span class="n">code</span> <span class="o">=</span> <span class="n">AskUserToVisitLinkAndGiveCode</span><span class="p">(</span><span class="n">auth_url</span><span class="p">)</span> <span class="c1"># Your customized authentication flow</span>
<span class="n">gauth</span><span class="o">.</span><span class="n">Auth</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="c1"># Authorize and build service from the code</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="filemanagement.html" class="btn btn-neutral float-right" title="File management made easy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quickstart" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, JunYoung Gwak, Scott Blevins, Robin Nabel, Google Inc, Iterative Inc

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>